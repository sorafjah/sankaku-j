<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ä¸‰è§’å®šè¦</title>
    <style>
        /* --- åŸºæœ¬çš„ãªãƒšãƒ¼ã‚¸è¨­å®š --- */
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden; /* ãƒšãƒ¼ã‚¸å…¨ä½“ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ç¦æ­¢ */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f0f0f0; /* èƒŒæ™¯è‰² */
        }

        /* --- SVGã¨æ“ä½œã‚¨ãƒªã‚¢ã®ã‚³ãƒ³ãƒ†ãƒŠ --- */
        #container {
            width: 100%;
            height: 100%;
            touch-action: none; /* ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¿ãƒƒãƒæ“ä½œ(ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã€ã‚ºãƒ¼ãƒ ãªã©)ã‚’ç„¡åŠ¹åŒ– */
            cursor: grab;
            position: relative;
        }
        #container:active {
            cursor: grabbing;
        }

        /* --- SVGè¦ç´ ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        #canvas {
            width: 100%;
            height: 100%;
            background-color: #ffffff; /* èƒŒæ™¯ã‚’ç™½ã«å¤‰æ›´ */
        }

        /* --- ä¸‰è§’å®šè¦æœ¬ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .ruler-body {
            fill: rgba(135, 206, 250, 0.4); /* å®šè¦ã‚‰ã—ã„åŠé€æ˜ã®æ°´è‰² (ã•ã‚‰ã«è–„ã) */
            stroke: #4a4a4a;
            stroke-width: 2;
            stroke-linejoin: round; /* è§’ã‚’ä¸¸ã‚ã‚‹ */
        }

        /* --- è§’åº¦ãƒãƒ¼ã‚¯ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .angle-mark {
            fill: none; /* å¡—ã‚Šã¤ã¶ã—ã‚’ç„¡ã—ã« */
            stroke: #333; /* é»’ç·šã«å¤‰æ›´ */
            stroke-width: 2; /* å°‘ã—å¤ªãã—ã¦è¦‹ã‚„ã™ã */
            stroke-linecap: round;
        }

        /* 90åº¦ãƒãƒ¼ã‚¯ã®å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .angle-mark-90 {
            fill: none;
        }

        /* --- è§’åº¦ãƒ©ãƒ™ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .angle-label {
            font-size: 20px;
            font-weight: bold;
            fill: #111;
            text-anchor: middle;
            dominant-baseline: middle;
            paint-order: stroke; /* æ–‡å­—ã®ç¸å–ã‚Šã‚’å…ˆã«æç”» */
            stroke: rgba(255, 255, 255, 0.8);
            stroke-width: 4px;
            stroke-linejoin: round;
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ– */
        }

        /* --- UIè¦ç´  --- */
        .ui-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid #ccc;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            font-size: 24px;
            color: #333;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.1s ease, box-shadow 0.1s ease;
        }
        .ui-button:hover {
            background-color: #fff;
        }
        .ui-button:active {
            transform: scale(0.95);
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }
    </style>
</head>
<body>

    <div id="container">
        <svg id="canvas">
            <!-- 
                ä¸‰è§’å®šè¦å…¨ä½“ã‚’ã“ã®<g>è¦ç´ ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã¾ã™ã€‚
                JavaScriptã‹ã‚‰ã¯ã€ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®transformå±æ€§ã‚’æ“ä½œã™ã‚‹ã“ã¨ã§ã€
                ç§»å‹•ã€å›è»¢ã€æ‹¡å¤§ãƒ»ç¸®å°ã‚’ã¾ã¨ã‚ã¦è¡Œã„ã¾ã™ã€‚
            -->
            <g id="ruler-group">
                <!-- ä¸‰è§’å½¢ã®æœ¬ä½“ -->
                <polygon id="triangle-shape" class="ruler-body" />

                <!-- è§’åº¦ã‚’ç¤ºã™ãƒãƒ¼ã‚¯ -->
                <g id="angle-marks">
                    <path id="angle-mark-30" class="angle-mark" />
                    <path id="angle-mark-60" class="angle-mark" />
                    <path id="angle-mark-90" class="angle-mark angle-mark-90" />
                </g>

                <!-- è§’åº¦ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ« -->
                <g id="angle-labels">
                    <text id="angle-label-30" class="angle-label">30Â°</text>
                    <text id="angle-label-60" class="angle-label">60Â°</text>
                    <text id="angle-label-90" class="angle-label">90Â°</text>
                </g>
            </g>
        </svg>
    </div>
    
    <!-- ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ -->
    <button id="reset-button" class="ui-button" title="ãƒªã‚»ãƒƒãƒˆ">ğŸ”„</button>

    <script>
        // --- DOMè¦ç´ ã®å–å¾— ---
        const container = document.getElementById('container');
        const svg = document.getElementById('canvas');
        const rulerGroup = document.getElementById('ruler-group');
        const resetButton = document.getElementById('reset-button');

        // --- ä¸‰è§’å½¢ã®å¹¾ä½•å­¦çš„å®šç¾© ---
        // è¾ºã®æ¯”ç‡ 1 : sqrt(3) : 2 ã‚’ã‚‚ã¨ã«é ‚ç‚¹åº§æ¨™ã‚’å®šç¾©ã—ã¾ã™ã€‚
        // ã“ã“ã§ã¯30Â°ã®å¯¾è¾ºã®é•·ã•ã‚’åŸºæº–ã¨ã—ã¾ã™ã€‚
        const BASE_LENGTH = 200; // 30Â°ã®å¯¾è¾ºã®é•·ã• (ãƒ”ã‚¯ã‚»ãƒ«)
        const vertices = {
            p90: { x: 0, y: BASE_LENGTH * Math.sqrt(3) }, // 90Â°ã®é ‚ç‚¹
            p30: { x: 0, y: 0 },                       // 30Â°ã®é ‚ç‚¹ (ä¿®æ­£)
            p60: { x: BASE_LENGTH, y: BASE_LENGTH * Math.sqrt(3) }  // 60Â°ã®é ‚ç‚¹ (ä¿®æ­£)
        };

        // --- çŠ¶æ…‹ç®¡ç† ---
        // ä¸‰è§’å®šè¦ã®ç¾åœ¨ã®çŠ¶æ…‹ï¼ˆä½ç½®ã€ã‚¹ã‚±ãƒ¼ãƒ«ã€è§’åº¦ï¼‰ã‚’ä¿æŒã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        let transformState = {
            x: 0,
            y: 0,
            scale: 1.0,
            angle: 0, // åº¦æ•°æ³• (degrees)
        };
        // ãƒªã‚»ãƒƒãƒˆç”¨ã«åˆæœŸçŠ¶æ…‹ã‚’ä¿å­˜
        const initialTransformState = { ...transformState };

        // --- ãƒã‚¤ãƒ³ã‚¿ï¼ˆã‚¿ãƒƒãƒ/ãƒã‚¦ã‚¹ï¼‰ã®çŠ¶æ…‹ç®¡ç† ---
        // ç¾åœ¨ç”»é¢ã«è§¦ã‚Œã¦ã„ã‚‹ãƒã‚¤ãƒ³ã‚¿ã®æƒ…å ±ã‚’ä¿æŒã—ã¾ã™ã€‚
        // Mapã‚’ä½¿ã†ã“ã¨ã§ã€è¤‡æ•°ã®ãƒã‚¤ãƒ³ã‚¿(multi-touch)ã‚’åŠ¹ç‡çš„ã«ç®¡ç†ã§ãã¾ã™ã€‚
        const pointers = new Map();
        let lastPointerState = { // 2æœ¬æŒ‡æ“ä½œç”¨ã®å‰å›ãƒ•ãƒ¬ãƒ¼ãƒ ã®çŠ¶æ…‹
            distance: 0,
            angle: 0,
            midpoint: { x: 0, y: 0 }
        };


        // --- åˆæœŸåŒ–å‡¦ç† ---
        function initialize() {
            setupTriangle();
            centerRuler();
            addEventListeners();
            requestAnimationFrame(update); // æç”»ãƒ«ãƒ¼ãƒ—ã‚’é–‹å§‹
        }

        // ä¸‰è§’å½¢ã®SVGè¦ç´ ã‚’ç”Ÿæˆãƒ»è¨­å®š
        function setupTriangle() {
            // 1. ä¸‰è§’å½¢ã®ãƒãƒªã‚´ãƒ³ã‚’è¨­å®š
            const triangleShape = document.getElementById('triangle-shape');
            const points = `${vertices.p30.x},${vertices.p30.y} ${vertices.p90.x},${vertices.p90.y} ${vertices.p60.x},${vertices.p60.y}`; // é ‚ç‚¹ã®é †ç•ªã‚’ä¿®æ­£
            triangleShape.setAttribute('points', points);

            // 2. è§’åº¦ãƒãƒ¼ã‚¯ã¨ãƒ©ãƒ™ãƒ«ã®ä½ç½®ã‚’è¨ˆç®—ã—ã¦è¨­å®š
            setupAngleIndicators();
        }

        // è§’åº¦ãƒãƒ¼ã‚¯ã¨ãƒ©ãƒ™ãƒ«ã‚’SVGä¸Šã«é…ç½®
        function setupAngleIndicators() {
            const MARK_RADIUS = 40; // è§’åº¦ãƒãƒ¼ã‚¯ã®åŠå¾„

            // --- 30Â°ã®ãƒãƒ¼ã‚¯ (é ‚ç‚¹ p30 at 0,0) ---
            const p30 = vertices.p30;
            const angle30 = 30 * Math.PI / 180;
            const p30_1 = { x: p30.x, y: p30.y + MARK_RADIUS }; // yè»¸ä¸Šã®ç‚¹
            const p30_2 = { x: p30.x + MARK_RADIUS * Math.sin(angle30), y: p30.y + MARK_RADIUS * Math.cos(angle30) }; // æ–œè¾ºä¸Šã®ç‚¹
            document.getElementById('angle-mark-30').setAttribute('d', 
                `M ${p30_1.x} ${p30_1.y} A ${MARK_RADIUS} ${MARK_RADIUS} 0 0 0 ${p30_2.x} ${p30_2.y}`); // sweep-flagã‚’ 1 ã‹ã‚‰ 0 ã«å¤‰æ›´ã—ã€ã‚«ãƒ¼ãƒ–ã‚’åè»¢

            // --- 60Â°ã®ãƒãƒ¼ã‚¯ (é ‚ç‚¹ p60 at bottom-right) ---
            const p60 = vertices.p60;
            const angle60 = 60 * Math.PI / 180;
            const p60_1 = { x: p60.x - MARK_RADIUS, y: p60.y }; // æ°´å¹³ç·šä¸Šã®ç‚¹
            const p60_2 = { x: p60.x - MARK_RADIUS * Math.cos(angle60), y: p60.y - MARK_RADIUS * Math.sin(angle60) }; // æ–œè¾ºä¸Šã®ç‚¹
            document.getElementById('angle-mark-60').setAttribute('d', 
                `M ${p60_1.x} ${p60_1.y} A ${MARK_RADIUS} ${MARK_RADIUS} 0 0 1 ${p60_2.x} ${p60_2.y}`); // sweep-flagã‚’ 0 ã‹ã‚‰ 1 ã«å¤‰æ›´ã—ã€ã‚«ãƒ¼ãƒ–ã‚’åè»¢

            // --- 90Â°ã®ãƒãƒ¼ã‚¯ ---
            const p90 = vertices.p90;
            const size90 = MARK_RADIUS * 0.8;
            document.getElementById('angle-mark-90').setAttribute('d', 
                `M ${p90.x} ${p90.y - size90} L ${p90.x + size90} ${p90.y - size90} L ${p90.x + size90} ${p90.y}`);
            
            // ãƒ©ãƒ™ãƒ«ã®åˆæœŸä½ç½®è¨­å®šï¼ˆupdateãƒ«ãƒ¼ãƒ—ã§å‹•çš„ã«æ›´æ–°ã•ã‚Œã‚‹ï¼‰
            document.getElementById('angle-label-30').setAttribute('x', vertices.p30.x);
            document.getElementById('angle-label-30').setAttribute('y', vertices.p30.y);
            document.getElementById('angle-label-60').setAttribute('x', vertices.p60.x);
            document.getElementById('angle-label-60').setAttribute('y', vertices.p60.y);
            document.getElementById('angle-label-90').setAttribute('x', vertices.p90.x);
            document.getElementById('angle-label-90').setAttribute('y', vertices.p90.y);
        }

        // å®šè¦ã‚’ç”»é¢ä¸­å¤®ã«é…ç½®
        function centerRuler() {
            const bbox = rulerGroup.getBBox(); // ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹ã‚’å–å¾—
            transformState.x = (svg.clientWidth / 2) - (bbox.x + bbox.width / 2);
            transformState.y = (svg.clientHeight / 2) - (bbox.y + bbox.height / 2);
            
            // åˆæœŸçŠ¶æ…‹ã‚’æ›´æ–°
            initialTransformState.x = transformState.x;
            initialTransformState.y = transformState.y;
        }

        // --- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ç™»éŒ² ---
        function addEventListeners() {
            container.addEventListener('pointerdown', onPointerDown);
            container.addEventListener('pointermove', onPointerMove);
            container.addEventListener('pointerup', onPointerUp);
            container.addEventListener('pointercancel', onPointerUp);
            container.addEventListener('wheel', onWheel, { passive: false }); // ãƒ›ã‚¤ãƒ¼ãƒ«ã§ã®ãƒšãƒ¼ã‚¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ–
            resetButton.addEventListener('click', resetTransform);
        }

        // --- ãƒã‚¤ãƒ³ã‚¿ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒãƒ³ãƒ‰ãƒ© ---

        function onPointerDown(e) {
            pointers.set(e.pointerId, { x: e.clientX, y: e.clientY });
            container.setPointerCapture(e.pointerId); // ãƒã‚¤ãƒ³ã‚¿ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã€é ˜åŸŸå¤–ã«å‡ºã¦ã‚‚ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘å–ã‚‹

            if (pointers.size === 2) {
                // 2æœ¬æŒ‡æ“ä½œãŒé–‹å§‹ã•ã‚ŒãŸã‚‰ã€ãã®æ™‚ç‚¹ã§ã®çŠ¶æ…‹ã‚’è¨˜éŒ²
                updateLastPointerState();
            }
        }

        function onPointerMove(e) {
            if (!pointers.has(e.pointerId)) return;

            // ãƒã‚¤ãƒ³ã‚¿ã®ä½ç½®ã‚’æ›´æ–°
            pointers.set(e.pointerId, { x: e.clientX, y: e.clientY });

            if (pointers.size === 1) {
                // --- 1æœ¬æŒ‡: ç§»å‹• ---
                // movementX/Yã¯ã‚¹ã‚±ãƒ¼ãƒ«ã®å½±éŸ¿ã‚’å—ã‘ãªã„ãŸã‚ã€ãã®ã¾ã¾åŠ ç®—ã§ãã‚‹
                transformState.x += e.movementX;
                transformState.y += e.movementY;
            } else if (pointers.size === 2) {
                // --- 2æœ¬æŒ‡: å›è»¢ã¨æ‹¡å¤§ãƒ»ç¸®å° ---
                const currentPointers = Array.from(pointers.values());
                const p1 = currentPointers[0];
                const p2 = currentPointers[1];
                
                // ç¾åœ¨ã®2ç‚¹é–“ã®è·é›¢ã€è§’åº¦ã€ä¸­å¿ƒç‚¹ã‚’è¨ˆç®—
                const distance = Math.hypot(p1.x - p2.x, p1.y - p2.y);
                const angle = Math.atan2(p1.y - p2.y, p1.x - p2.x);
                const midpoint = { x: (p1.x + p2.x) / 2, y: (p1.y + p2.y) / 2 };

                // 1. ã‚¹ã‚±ãƒ¼ãƒ«
                const scaleFactor = distance / lastPointerState.distance;
                // ä¸­å¿ƒç‚¹ã‹ã‚‰ã®ç›¸å¯¾ä½ç½®ã‚’ä¿ã¡ãªãŒã‚‰ã‚¹ã‚±ãƒ¼ãƒ«ã‚’é©ç”¨
                transformState.x = midpoint.x + (transformState.x - midpoint.x) * scaleFactor;
                transformState.y = midpoint.y + (transformState.y - midpoint.y) * scaleFactor;
                transformState.scale *= scaleFactor;

                // 2. å›è»¢
                const angleDiff = angle - lastPointerState.angle;
                const cos = Math.cos(angleDiff);
                const sin = Math.sin(angleDiff);
                const dx = transformState.x - midpoint.x;
                const dy = transformState.y - midpoint.y;
                transformState.x = midpoint.x + (dx * cos - dy * sin);
                transformState.y = midpoint.y + (dx * sin + dy * cos);
                transformState.angle += angleDiff * (180 / Math.PI); // åº¦ã«å¤‰æ›ã—ã¦åŠ ç®—
                
                // ç¾åœ¨ã®çŠ¶æ…‹ã‚’æ¬¡ãƒ•ãƒ¬ãƒ¼ãƒ ã®ãŸã‚ã«ä¿å­˜
                lastPointerState = { distance, angle, midpoint };
            }
        }

        function onPointerUp(e) {
            pointers.delete(e.pointerId);
            container.releasePointerCapture(e.pointerId);
        }
        
        // --- ãƒã‚¦ã‚¹ãƒ›ã‚¤ãƒ¼ãƒ«ã«ã‚ˆã‚‹ã‚ºãƒ¼ãƒ  ---
        function onWheel(e) {
            e.preventDefault(); // ãƒšãƒ¼ã‚¸ã®ã‚ºãƒ¼ãƒ ã‚’é˜²ã

            const scaleFactor = e.deltaY < 0 ? 1.1 : 0.9; // ãƒ›ã‚¤ãƒ¼ãƒ«æ–¹å‘ã§å€ç‡å¤‰æ›´
            const mousePos = { x: e.clientX, y: e.clientY };

            // ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã‚’ä¸­å¿ƒã«ã‚ºãƒ¼ãƒ 
            transformState.x = mousePos.x + (transformState.x - mousePos.x) * scaleFactor;
            transformState.y = mousePos.y + (transformState.y - mousePos.y) * scaleFactor;
            transformState.scale *= scaleFactor;
        }

        // 2æœ¬æŒ‡æ“ä½œã®ãŸã‚ã«ã€å‰å›ã®ãƒã‚¤ãƒ³ã‚¿çŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
        function updateLastPointerState() {
            const currentPointers = Array.from(pointers.values());
            if (currentPointers.length < 2) return;
            const p1 = currentPointers[0];
            const p2 = currentPointers[1];
            
            lastPointerState.distance = Math.hypot(p1.x - p2.x, p1.y - p2.y);
            lastPointerState.angle = Math.atan2(p1.y - p2.y, p1.x - p2.x);
            lastPointerState.midpoint = { x: (p1.x + p2.x) / 2, y: (p1.y + p2.y) / 2 };
        }
        
        // --- æç”»æ›´æ–° ---
        // requestAnimationFrameãƒ«ãƒ¼ãƒ—ã§å‘¼ã³å‡ºã•ã‚Œã€çŠ¶æ…‹ã«åŸºã¥ã„ã¦SVGè¦ç´ ã®transformã‚’æ›´æ–°ã™ã‚‹
        function update() {
            const { x, y, scale, angle } = transformState;
            
            // 1. å®šè¦æœ¬ä½“ã® transform ã‚’æ›´æ–°
            rulerGroup.setAttribute('transform', `translate(${x}, ${y}) rotate(${angle}) scale(${scale})`);

            // 2. è§’åº¦ãƒ©ãƒ™ãƒ«ã®ä½ç½®ã¨ transform ã‚’å‹•çš„ã«æ›´æ–°
            updateLabels();
            
            requestAnimationFrame(update); // æ¬¡ã®ãƒ•ãƒ¬ãƒ¼ãƒ ã§å†åº¦updateã‚’å‘¼ã³å‡ºã™
        }

        // ãƒ©ãƒ™ãƒ«ã®ä½ç½®ã¨å‘ãã‚’ã€ç¾åœ¨ã®ã‚¹ã‚±ãƒ¼ãƒ«ã¨å›è»¢ã«åˆã‚ã›ã¦æ›´æ–°ã™ã‚‹é–¢æ•°
        function updateLabels() {
            const { scale, angle } = transformState;
            const LOCAL_OFFSET = 25; // é ‚ç‚¹ã‹ã‚‰ã®å›ºå®šã‚ªãƒ•ã‚»ãƒƒãƒˆé‡ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«åº§æ¨™ï¼‰
            const BASE_FONT_SIZE = 20; // åŸºæœ¬ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º

            // ã‚¹ã‚±ãƒ¼ãƒ«ã«å¿œã˜ã¦ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã¨ç¸å–ã‚Šã®å¤ªã•ã‚’å‹•çš„ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€
            // è¦‹ãŸç›®ã®å¤§ãã•ã‚’ä¸€å®šã«ä¿ã¡ã¾ã™ã€‚
            const currentFontSize = BASE_FONT_SIZE / scale;
            const currentStrokeWidth = 4 / scale;

            // --- 30Â° ãƒ©ãƒ™ãƒ«ã®æ›´æ–° ---
            const label30 = document.getElementById('angle-label-30');
            const p30 = vertices.p30;
            // ãƒ©ãƒ™ãƒ«ã®ä½ç½®ã‚’ã€é ‚ç‚¹ã‹ã‚‰ã®å›ºå®šãƒ­ãƒ¼ã‚«ãƒ«ã‚ªãƒ•ã‚»ãƒƒãƒˆã§æ±ºå®š
            const label30X = p30.x - LOCAL_OFFSET * 0.7;
            const label30Y = p30.y - LOCAL_OFFSET * 0.7;
            label30.setAttribute('x', label30X);
            label30.setAttribute('y', label30Y);
            label30.setAttribute('font-size', currentFontSize);
            label30.setAttribute('stroke-width', currentStrokeWidth);
            // ãƒ©ãƒ™ãƒ«è‡ªèº«ã®ä½ç½®ã‚’ä¸­å¿ƒã«ã€å®šè¦ã®å›è»¢ã¨é€†å‘ãã«å›è»¢ã•ã›ã‚‹
            label30.setAttribute('transform', `rotate(${-angle}, ${label30X}, ${label30Y})`);

            // --- 60Â° ãƒ©ãƒ™ãƒ«ã®æ›´æ–° ---
            const label60 = document.getElementById('angle-label-60');
            const p60 = vertices.p60;
            const label60X = p60.x + LOCAL_OFFSET * 0.6;
            const label60Y = p60.y + LOCAL_OFFSET * 0.6;
            label60.setAttribute('x', label60X);
            label60.setAttribute('y', label60Y);
            label60.setAttribute('font-size', currentFontSize);
            label60.setAttribute('stroke-width', currentStrokeWidth);
            label60.setAttribute('transform', `rotate(${-angle}, ${label60X}, ${label60Y})`);

            // --- 90Â° ãƒ©ãƒ™ãƒ«ã®æ›´æ–° ---
            const label90 = document.getElementById('angle-label-90');
            const p90 = vertices.p90;
            const label90X = p90.x - LOCAL_OFFSET * 0.7;
            const label90Y = p90.y + LOCAL_OFFSET * 0.7;
            label90.setAttribute('x', label90X);
            label90.setAttribute('y', label90Y);
            label90.setAttribute('font-size', currentFontSize);
            label90.setAttribute('stroke-width', currentStrokeWidth);
            label90.setAttribute('transform', `rotate(${-angle}, ${label90X}, ${label90Y})`);
        }

        // --- ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ ---
        function resetTransform() {
            transformState = { ...initialTransformState };
        }

        // --- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ ---
        document.addEventListener('DOMContentLoaded', initialize);

    </script>
</body>
</html>




